[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=0
PauseHotkeyMod=0
StopHotkey=0
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=fa2259a0-aba7-4ad4-a148-af0edbe59d30
Description=votingtools
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=mainfrm
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
wind = 0
Event mainfrm.LoadOver
wind = Plugin.Window.Find("ConsoleWindowClass", GetExeDir() & "cli_wallet.exe")
End Event
Event mainfrm.bt_voteall.Click
If mainfrm.tb_voteaccount.Text = "" or wind = 0 Then 
Else 
	Call doVoteAll
	
End If

End Event

Sub doVoteAll
	members = split(mainfrm.txt_members.Text, vbCrLf)
	For i = 0 To UBound(members)
	Call doVote(members(i))
	Delay 1000
	Next
End Sub

Sub doVote(miner)
   If wind = 0 or miner = "" Then 
   	Exit sub
   End If
   Call Plugin.Window.SendString(wind, "vote_for_miner " &  mainfrm.tb_voteaccount.Text & " " & miner & " true true")
   Call Plugin.Window.SendKeyPress(wind,13)
End Sub
Sub doUnVote(miner)
   If wind = 0 or miner = "" Then 
   	Exit sub
   End If
   Call Plugin.Window.SendString(wind, "vote_for_miner " &  mainfrm.tb_voteaccount.Text & " " & miner & " false true")
   Call Plugin.Window.SendKeyPress(wind,13)
End Sub
Event mainfrm.bt_vote.Click
If mainfrm.txt_miner.Text = "" Then 
	//end
Else 
	Call doVote(mainfrm.txt_miner.Text)
End If
End Event
Event mainfrm.bt_unvote.Click
If mainfrm.txt_miner.Text = "" Then 
	//end
Else 
	Call doUnVote(mainfrm.txt_miner.Text)
End If
End Event
Event mainfrm.bt_minerscount.Click
If wind = 0 or  mainfrm.tb_voteaccount.Text = "" or mainfrm.tb_minerscount.Text = "" Then 
   	//end
   	Else 
   	Call Plugin.Window.SendString(wind, "set_desired_miner_count " &  mainfrm.tb_voteaccount.Text & " " & mainfrm.tb_minerscount.Text & " true")
    Call Plugin.Window.SendKeyPress(wind,13)
End If
   
End Event

